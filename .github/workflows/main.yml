on:
  pull_request:
     paths:
        - '**/validator*'
env:
   GITHUB_PAT: ''
jobs:

   job1:
      name: Test
      runs-on: ubuntu-latest
      env:
         PATTERN: '@[a-z0-9]+'
         GH_TOKEN: ${{ github.token }}
      outputs:
          result: ${{ steps.one.outputs.result}}
      steps:
          - uses: actions/checkout@v3
            with:
                fetch-depth: 2

          - id: one
            run: |
             d=$(gh pr diff | grep -E $PATTERN)

             echo "$d"
             if [[ -n $d ]]; then
               echo "result=yes" >> $GITHUB_OUTPUT
             else
              exit 1
             fi

   job2:
      name: Get and set PAT
      runs-on: ubuntu-latest
      permissions: write-all
      steps:
         - uses: actions/github-script@v6
           with:
             script: |
               const s = await github.rest.actions.getRepoSecret({
               owner: context.repo.owner,
               repo: context.repo.repo,
               secret_name: 'FOO',
               });

               console.log(s)
            
    
